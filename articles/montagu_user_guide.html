<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Montagu API from R â€¢ montagu</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Montagu API from R">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">montagu</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/montagu_user_guide.html">Montagu API from R</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/vimc/montagu-r">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Montagu API from R</h1>
                        <h4 class="author">VIMC Technical Team</h4>
            
            <h4 class="date">2019-10-04</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/vimc/montagu-r/blob/master/vignettes/montagu_user_guide.Rmd"><code>vignettes/montagu_user_guide.Rmd</code></a></small>
      <div class="hidden name"><code>montagu_user_guide.Rmd</code></div>

    </div>

    
    
<p>In this vignette, we describe a typical example of building a model in R, which uses the demography and templates available through the Montagu API, and submited burden estimates to it. We will proceed very naively and cover all of the important functionality on the way.</p>
<div id="identify-the-montagu-server" class="section level3">
<h3 class="hasAnchor">
<a href="#identify-the-montagu-server" class="anchor"></a>Identify the Montagu Server</h3>
<p>Begin by identifying the Montagu server to connect to. You must have an account on this server; typically this will be our live production server, and you will have received login information on joining VIMC. Identify the server as follows:-</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_server_global_default_set">montagu_server_global_default_set</a></span>(</a>
<a class="sourceLine" id="cb1-2" title="2">  montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_server">montagu_server</a></span>(<span class="st">"production"</span>, <span class="st">"montagu.vaccineimpact.org"</span>))</a></code></pre></div>
<p>The next time you query the server, you may be asked to login with a username and password.</p>
</div>
<div id="basic-information" class="section level3">
<h3 class="hasAnchor">
<a href="#basic-information" class="anchor"></a>Basic Information</h3>
<p>For many of the montagu api functions, you will need to provide your modelling group id, and your disease id. Your group id will have been communicated on joining VIMC; the disease ids can be looked up with a simple function call like this:-</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_diseases">montagu_diseases</a></span>()</a></code></pre></div>
<pre><code>##         id                         name
## 1     HepB                         HepB
## 2      Hib                          Hib
## 3      HPV                          HPV
## 4       JE                           JE
## 5  Measles                      Measles
## 6     MenA                         MenA
## 7      PCV                          PCV
## 8     Rota                    Rotavirus
## 9  Rubella                      Rubella
## 10      YF                 Yellow fever
## 11     DTP Diphtheria Tetanus Pertussis</code></pre>
</div>
<div id="touchstones" class="section level3">
<h3 class="hasAnchor">
<a href="#touchstones" class="anchor"></a>Touchstones</h3>
<p>A touchstone is an identifier that links:</p>
<ul>
<li>A request from VIMC to the modelling groups to provide burden estimates</li>
<li>The input data (coverage and demography) provided to calculate those estimates</li>
<li>The estimates submitted by the groups using the input data.</li>
</ul>
<p>Touchstone ids are referred to as a basename and a version together. Errata to the input data may be addressed with a new touchstone version. Generally, modelling groups will know which touchstone they are required to run models against. To lookup all the currently open touchstones for a group:-</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_touchstone_versions">montagu_touchstone_versions</a></span>(<span class="st">"IC-Garske"</span>, <span class="dt">require_open =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>##                  id            name version                 description
## 4      201910test-1      201910test       1      201910test (version 1)
## 7      201710gavi-5      201710gavi       5      201710gavi (version 5)
## 8 201810synthetic-2 201810synthetic       2 201810synthetic (version 2)
##   status
## 4   open
## 7   open
## 8   open</code></pre>
<p>If we knew the basic touchstone name (without version) that we were interested in, then we could also have asked:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_touchstone_versions">montagu_touchstone_versions</a></span>(<span class="st">"IC-Garske"</span>, <span class="st">"201710gavi"</span>, <span class="dt">require_open =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>##             id       name version            description status
## 1 201710gavi-5 201710gavi       5 201710gavi (version 5)   open</code></pre>
</div>
<div id="scenarios" class="section level3">
<h3 class="hasAnchor">
<a href="#scenarios" class="anchor"></a>Scenarios</h3>
<p>Within a touchstone, we may have various scenarios, describing different vaccination conditions. These vary across diseases due to the different types of vaccination approaches that have been employed. We look our the scenarios we are required to model for a touchstone with:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_scenarios">montagu_scenarios</a></span>(<span class="st">"IC-Garske"</span>, <span class="st">"201710gavi-5"</span>)</a></code></pre></div>
<pre><code>##          scenario_id                  description disease
## 1  yf-no-vaccination               No vaccination      YF
## 2    yf-routine-gavi               Routine, total      YF
## 3 yf-preventive-gavi Campaign (preventive), total      YF</code></pre>
<p>We can then look up the status a particular scenario within this touchstone:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_scenario_status">montagu_scenario_status</a></span>(<span class="st">"IC-Garske"</span>, <span class="st">"201710gavi-5"</span>, <span class="st">"yf-routine-gavi"</span>)</a></code></pre></div>
<pre><code>## [1] "valid"</code></pre>
<p>and if that status were not valid, then we can query any problems with:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_scenario_problems">montagu_scenario_problems</a></span>(<span class="st">"IC-Garske"</span>, <span class="st">"201710gavi-5"</span>, <span class="st">"yf-routine-gavi"</span>)</a></code></pre></div>
<pre><code>## NULL</code></pre>
</div>
<div id="expectations---years-ages-countries-and-outcomes" class="section level3">
<h3 class="hasAnchor">
<a href="#expectations---years-ages-countries-and-outcomes" class="anchor"></a>Expectations - years, ages, countries and outcomes</h3>
<p>For a given touchstone, modelling groups are required to produce burden estimates stratified by calendar year, and by age. The expectations about time and age will be consistent across scenarios. We can look up these expectations like so:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_expectations">montagu_expectations</a></span>(<span class="st">"IC-Garske"</span>, <span class="st">"201710gavi-5"</span>)</a></code></pre></div>
<pre><code>##   id           description min_year max_year min_age max_age
## 1 30 YF:IC-Garske:standard     2000     2100       0     100
##   min_birth_cohort max_birth_cohort disease
## 1             1900             2100      YF</code></pre>
<p>Some modelling groups model more than one disease, in which case a row appears for each disease. And additionally, if there is some reason to have different expectations for different scenarios, then multiple lines for the same disease may appear, with a difference in the description column indicating the scenario.</p>
<p>If we already knew the expectation id, we could look up a single expectation with</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_expectation">montagu_expectation</a></span>(<span class="st">"IC-Garske"</span>, <span class="st">"201710gavi-5"</span>, <span class="dv">30</span>)</a></code></pre></div>
<pre><code>## $id
## [1] 30
##
## $description
## [1] "YF:IC-Garske:standard"
##
## $min_year
## [1] 2000
##
## $max_year
## [1] 2100
##
## $min_age
## [1] 0
##
## $max_age
## [1] 100
##
## $min_birth_cohort
## [1] 1900
##
## $max_birth_cohort
## [1] 2100
##
## $disease
## NULL</code></pre>
<p>The countries for which estimates are required can vary between disease, and between scenarios. To retrieve the list of countries that are required for a particular expectation:-</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">countries &lt;-<span class="st"> </span>montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_expectation_countries">montagu_expectation_countries</a></span>(<span class="st">"IC-Garske"</span>, <span class="st">"201710gavi-5"</span>, <span class="dv">30</span>)</a>
<a class="sourceLine" id="cb18-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(countries)</a></code></pre></div>
<pre><code>##    id                     name
## 1 AGO                   Angola
## 2 BDI                  Burundi
## 3 BEN                    Benin
## 4 BFA             Burkina Faso
## 5 CAF Central African Republic
## 6 CIV            Cote d'Ivoire</code></pre>
<p>To see which outcomes are required for an expectation:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_expectation_outcomes">montagu_expectation_outcomes</a></span>(<span class="st">"IC-Garske"</span>, <span class="st">"201710gavi-5"</span>, <span class="dv">30</span>)</a></code></pre></div>
<pre><code>## [[1]]
## [[1]]$code
## [1] "deaths"
##
## [[1]]$name
## [1] "deaths"
##
##
## [[2]]
## [[2]]$code
## [1] "cases"
##
## [[2]]$name
## [1] "cases"
##
##
## [[3]]
## [[3]]$code
## [1] "dalys"
##
## [[3]]$name
## [1] "dalys"</code></pre>
<p>And to confirm which scnearios an expectation applies to (which should align with the description text for the expectation):</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_expectation_applicable_scenarios">montagu_expectation_applicable_scenarios</a></span>(<span class="st">"IC-Garske"</span>, <span class="st">"201710gavi-5"</span>, <span class="dv">30</span>)</a></code></pre></div>
<pre><code>## [1] "yf-no-vaccination"  "yf-preventive-gavi" "yf-routine-gavi"</code></pre>
</div>
<div id="demography" class="section level3">
<h3 class="hasAnchor">
<a href="#demography" class="anchor"></a>Demography</h3>
<p>Montagu provides standardised demographic data necessary for running vaccine models. In the early stages of VIMC, we surveyed the groups to ascertain what demographic data they required, and Montagu provides the superset of all those data. If, however, your model needs demographic data not provided by Montagu, get in touch, as we want to make sure that demography is always consistent between different models.</p>
<p>We can list the available demographic data associated with a touchstone like this:-</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_demographics_list">montagu_demographics_list</a></span>(<span class="st">"201710gavi-5"</span>)</a></code></pre></div>
<pre><code>##              id                                             name gendered
## 1       as_fert                Fertility: Age-specific fertility    FALSE
## 2        births                    Fertility: Births (number of)    FALSE
## 3     qq_births     Fertility: Births (number of) - quinquennial    FALSE
## 4     as_births               Fertility: Births by age of mother    FALSE
## 5           cbr                Fertility: Crude birth rate (CBR)    FALSE
## 6      birth_mf                    Fertility: Sex-ratio at birth    FALSE
## 7      fert_tot                       Fertility: Total Fertility    FALSE
## 8  net_mig_rate                    Migration: Net migration rate    FALSE
## 9     mort_rate             Mortality: Central Death Rate (ASMR)     TRUE
## 10          cdr                Mortality: Crude death rate (CDR)    FALSE
## 11     mort_age                Mortality: Deaths (number) by age     TRUE
## 12     mort_tot                 Mortality: Deaths (total number)     TRUE
## 13      life_ex      Mortality: Expected remaining years of life     TRUE
## 14          lx0              Mortality: Life expectancy at birth     TRUE
## 15 unwpp_cm_nmr  Mortality: Neonatal Mortality Rate (28-day NMR)    FALSE
## 16      p_dying           Mortality: Probability of dying by age     TRUE
## 17  n_survivors Mortality: Survivors from a birth-cohort of 100k     TRUE
## 18    unwpp_imr          Mortality: Under 1 Mortality Rate (IMR)    FALSE
## 19   unwpp_u5mr         Mortality: Under 5 Mortality Rate (U5MR)    FALSE
## 20          pgr                          Population: Growth Rate    FALSE
## 21      int_pop   Population: Interpolated (1-year time and age)     TRUE
## 22       qq_pop   Population: Quinquennial (5-year time and age)     TRUE
## 23      tot_pop                                Population: Total     TRUE
##        source
## 1  dds-201710
## 2  dds-201710
## 3  dds-201710
## 4  dds-201710
## 5  dds-201710
## 6  dds-201710
## 7  dds-201710
## 8  dds-201710
## 9  dds-201710
## 10 dds-201710
## 11 dds-201710
## 12 dds-201710
## 13 dds-201710
## 14 dds-201710
## 15 dds-201710
## 16 dds-201710
## 17 dds-201710
## 18 dds-201710
## 19 dds-201710
## 20 dds-201710
## 21 dds-201710
## 22 dds-201710
## 23 dds-201710</code></pre>
<p>We can then retrieve a particular demographic statistic as follows:-</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">cbr &lt;-<span class="st"> </span>montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_demographic_data">montagu_demographic_data</a></span>(<span class="st">"cbr"</span>, <span class="st">"201710gavi-5"</span>)</a>
<a class="sourceLine" id="cb26-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(cbr)</a></code></pre></div>
<pre><code>##   country_code_numeric country_code     country age_from age_to year
## 1                    4          AFG Afghanistan        0      0 1950
## 2                    4          AFG Afghanistan        0      0 1951
## 3                    4          AFG Afghanistan        0      0 1952
## 4                    4          AFG Afghanistan        0      0 1953
## 5                    4          AFG Afghanistan        0      0 1954
## 6                    4          AFG Afghanistan        0      0 1955
##   gender    value
## 1   both 0.050000
## 2   both 0.050082
## 3   both 0.050244
## 4   both 0.050399
## 5   both 0.050546
## 6   both 0.050688</code></pre>
<div id="gender" class="section level4">
<h4 class="hasAnchor">
<a href="#gender" class="anchor"></a>Gender</h4>
<p>The example above, the central birth rate, is not gender-specific. Other fields are gender-specific, where data can be downloaded for â€˜femaleâ€™, â€˜maleâ€™, or the total of all people is called â€˜bothâ€™. By default â€˜bothâ€™ is returned, but to select a specific gender:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1">female_pop &lt;-<span class="st"> </span>montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_demographic_data">montagu_demographic_data</a></span>(<span class="st">"tot_pop"</span>, <span class="st">"201710gavi-5"</span>,</a>
<a class="sourceLine" id="cb28-2" title="2">                                                <span class="dt">gender_code =</span> <span class="st">"female"</span>)</a>
<a class="sourceLine" id="cb28-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(female_pop)</a></code></pre></div>
<pre><code>##   country_code_numeric country_code     country age_from age_to year
## 1                    4          AFG Afghanistan        0    120 1950
## 2                    4          AFG Afghanistan        0    120 1951
## 3                    4          AFG Afghanistan        0    120 1952
## 4                    4          AFG Afghanistan        0    120 1953
## 5                    4          AFG Afghanistan        0    120 1954
## 6                    4          AFG Afghanistan        0    120 1955
##   gender   value
## 1 female 3652874
## 2 female 3705031
## 3 female 3760979
## 4 female 3820747
## 5 female 3884348
## 6 female 3951800</code></pre>
</div>
<div id="format" class="section level4">
<h4 class="hasAnchor">
<a href="#format" class="anchor"></a>Format</h4>
<p>Data is also available in long format (the default), in which years and ages are reported in separate rows, or wide format, in which the years of time are represented as columns, making the resulting data shorter, but wider. For <a href="example:-" class="uri">example:-</a></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">as_fert &lt;-<span class="st"> </span>montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_demographic_data">montagu_demographic_data</a></span>(<span class="st">"as_fert"</span>, <span class="st">"201710gavi-5"</span>)</a>
<a class="sourceLine" id="cb30-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(as_fert)</a></code></pre></div>
<pre><code>## [1] "country_code_numeric" "country_code"         "country"
## [4] "age_from"             "age_to"               "year"
## [7] "gender"               "value"</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(as_fert)</a></code></pre></div>
<pre><code>## [1] 21000</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">as_fert_wide &lt;-<span class="st"> </span>montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_demographic_data">montagu_demographic_data</a></span>(<span class="st">"as_fert"</span>, <span class="st">"201710gavi-5"</span>,</a>
<a class="sourceLine" id="cb34-2" title="2">                                                  <span class="dt">wide =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb34-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(as_fert_wide)</a></code></pre></div>
<pre><code>##  [1] "country_code_numeric" "country_code"         "country"
##  [4] "age_from"             "age_to"               "gender"
##  [7] "X1950"                "X1955"                "X1960"
## [10] "X1965"                "X1970"                "X1975"
## [13] "X1980"                "X1985"                "X1990"
## [16] "X1995"                "X2000"                "X2005"
## [19] "X2010"                "X2015"                "X2020"
## [22] "X2025"                "X2030"                "X2035"
## [25] "X2040"                "X2045"                "X2050"
## [28] "X2055"                "X2060"                "X2065"
## [31] "X2070"                "X2075"                "X2080"
## [34] "X2085"                "X2090"                "X2095"</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(as_fert_wide)</a></code></pre></div>
<pre><code>## [1] 700</code></pre>
</div>
</div>
<div id="templates" class="section level3">
<h3 class="hasAnchor">
<a href="#templates" class="anchor"></a>Templates</h3>
<p>The above will give all the information required to build your own data frame for submitting the expected results. Alternatively, you can download burden estimate templates with the years, countries and ages already populated:-</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1">df &lt;-<span class="st"> </span>montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_central_burden_estimate_template">montagu_central_burden_estimate_template</a></span>(<span class="st">"IC-Garske"</span>, <span class="st">"201710gavi-5"</span>, <span class="dv">30</span>)</a>
<a class="sourceLine" id="cb38-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(df)</a></code></pre></div>
<pre><code>##   disease year age country country_name cohort_size deaths cases dalys
## 1      YF 2000   0     AGO       Angola          NA     NA    NA    NA
## 2      YF 2001   0     AGO       Angola          NA     NA    NA    NA
## 3      YF 2002   0     AGO       Angola          NA     NA    NA    NA
## 4      YF 2003   0     AGO       Angola          NA     NA    NA    NA
## 5      YF 2004   0     AGO       Angola          NA     NA    NA    NA
## 6      YF 2005   0     AGO       Angola          NA     NA    NA    NA</code></pre>
</div>
<div id="coverage" class="section level3">
<h3 class="hasAnchor">
<a href="#coverage" class="anchor"></a>Coverage</h3>
<p>We now need to obtain the coverage data relevant for our disease and touchstone, for each of the scenarios weâ€™re going to model. Letâ€™s look at the <code>yf-routine-gavi</code> coverage metadata.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1">montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_coverage_info">montagu_coverage_info</a></span>(<span class="st">"IC-Garske"</span>, <span class="st">"201710gavi-5"</span>, <span class="st">"yf-routine-gavi"</span>)</a></code></pre></div>
<pre><code>##     id touchstone_version                   name vaccine gavi_support
## 1 1182       201710gavi-5 YF: YF, none, campaign      YF   no vaccine
## 2  651       201710gavi-5  YF: YF, with, routine      YF        total
##   activity_type
## 1      campaign
## 2       routine</code></pre>
<p>And now letâ€™s retrieve the coverage data itself, and summarise it.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">cov &lt;-<span class="st"> </span>montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_coverage_data">montagu_coverage_data</a></span>(<span class="st">"IC-Garske"</span>, <span class="st">"201710gavi-5"</span>, <span class="st">"yf-routine-gavi"</span>)</a>
<a class="sourceLine" id="cb42-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(cov[cov<span class="op">$</span>coverage <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, ])</a></code></pre></div>
<pre><code>##          scenario               set_name vaccine gavi_support
## 1 yf-routine-gavi YF: YF, none, campaign      YF   no vaccine
## 2 yf-routine-gavi YF: YF, none, campaign      YF   no vaccine
## 3 yf-routine-gavi YF: YF, none, campaign      YF   no vaccine
## 4 yf-routine-gavi YF: YF, none, campaign      YF   no vaccine
## 5 yf-routine-gavi YF: YF, none, campaign      YF   no vaccine
## 6 yf-routine-gavi YF: YF, none, campaign      YF   no vaccine
##   activity_type country_code country year age_first age_last
## 1      campaign          AGO  Angola 1988         1      100
## 2      campaign          AGO  Angola 2016         1      100
## 3      campaign          BEN   Benin 1940         0      100
## 4      campaign          BEN   Benin 1944         0      100
## 5      campaign          BEN   Benin 1948         0      100
## 6      campaign          BEN   Benin 1952         0      100
##   age_range_verbatim           target   coverage
## 1               &lt;NA&gt; 2689316.38932258 0.24926759
## 2               &lt;NA&gt;          7067755 0.03486047
## 3               &lt;NA&gt;             &lt;NA&gt; 0.10682008
## 4               &lt;NA&gt;             &lt;NA&gt; 0.60071624
## 5               &lt;NA&gt;             &lt;NA&gt; 0.60228038
## 6               &lt;NA&gt;             &lt;NA&gt; 0.70605678</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/range">range</a></span>(cov<span class="op">$</span>year)</a></code></pre></div>
<pre><code>## [1] 1940 2100</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(cov<span class="op">$</span>country_code))</a></code></pre></div>
<pre><code>## [1] 32</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(cov)</a></code></pre></div>
<pre><code>## [1] 4048</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">ncol</a></span>(cov)</a></code></pre></div>
<pre><code>## [1] 13</code></pre>
<p>More information on the coverage is available in the Montagu Web Portal, but briefly:</p>
<ul>
<li>
<em>Coverage</em> is measured as a proportion of the original target population. It is possible for this to exceed 1, if more people were vaccinated than originally targeted.</li>
<li>
<em>Target</em> is the number of individuals targeted for vaccination. If this is <code>NA</code>, then assume the target population matches the demographic data, and the whole population is targeted.</li>
</ul>
<div id="long-or-wide-format" class="section level4">
<h4 class="hasAnchor">
<a href="#long-or-wide-format" class="anchor"></a>Long or Wide format</h4>
<p>The data above is formatted in what we call <code>long format</code>, in which one year is reported per row. Alternatively, you can specify:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1">cov &lt;-<span class="st"> </span>montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_coverage_data">montagu_coverage_data</a></span>(<span class="st">"IC-Garske"</span>, <span class="st">"201710gavi-5"</span>, <span class="st">"yf-routine-gavi"</span>, <span class="dt">format=</span><span class="st">"wide"</span>)</a>
<a class="sourceLine" id="cb52-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(cov)[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>]</a></code></pre></div>
<pre><code>##  [1] "scenario"           "set_name"           "vaccine"
##  [4] "gavi_support"       "activity_type"      "country_code"
##  [7] "country"            "age_first"          "age_last"
## [10] "age_range_verbatim" "coverage_1988"      "coverage_2016"
## [13] "target_1988"        "target_2016"        NA
## [16] NA                   NA                   NA
## [19] NA                   NA</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(cov)</a></code></pre></div>
<pre><code>## [1] 71</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">ncol</a></span>(cov)</a></code></pre></div>
<pre><code>## [1] 14</code></pre>
<p>Here, we have one row per country, and separate columns for <code>coverage_year</code> and <code>target_year</code>.</p>
</div>
<div id="returning-the-full-range-of-countries" class="section level4">
<h4 class="hasAnchor">
<a href="#returning-the-full-range-of-countries" class="anchor"></a>Returning the full range of countries</h4>
<p>By default, the coverage data returned is limited to those countries for which burden estimate data is required for the given scenario. HepB is a particular example, where different sets of countries are relevant in different scenarios, because the birth-dose vaccination is not applied in all countries where there is HepB vaccination. However, some groups prefer to model all of these scenarios similarly, with the same numbers of countries, hence they require the full coverage data for all countries. And for some diseases, the historic effects of vaccination in a country that is not required for estimates as present, may have relevance in their model to countries that are required.</p>
<p>For those cases, where all countries are required, the optional <code>all_countries</code> argument can be used.</p>
</div>
</div>
<div id="burden-estimate-sets" class="section level2">
<h2 class="hasAnchor">
<a href="#burden-estimate-sets" class="anchor"></a>Burden Estimate Sets</h2>
<p>The burden estimate set defines the results of the models, which modelling groups submit back to Montagu. To view the burden estimate sets already uploaded, for a group, touchstone and scenario:-</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_burden_estimate_sets">montagu_burden_estimate_sets</a></span>(<span class="st">"IC-Garske"</span>, <span class="st">"201710gavi-5"</span>, <span class="st">"yf-no-vaccination"</span>))</a></code></pre></div>
<pre><code>##     id              uploaded_on    uploaded_by               type
## 2  687 2018-04-06T13:08:18.883Z katy.gaythorpe   central-averaged
## 4  698 2018-05-30T09:27:32.341Z    tini.garske central-single-run
## 1 1034 2019-04-04T13:01:58.052Z katy.gaythorpe   central-averaged
## 3 1037 2019-04-05T09:04:59.238Z katy.gaythorpe   central-averaged
##                                                                details
## 2 Averaged over posterior predictive distribution for model parameters
## 4                                                                    x
## 1                      The median of posterior predictive distribution
## 3                      The median of posterior predictive distribution
##     status
## 2 complete
## 4    empty
## 1 complete
## 3 complete</code></pre>
<p>If we know the burden estimate set id, we can also get a list of information about a burden estimate set with:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1">montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_burden_estimate_set_info">montagu_burden_estimate_set_info</a></span>(<span class="st">"IC-Garske"</span>, <span class="st">"201710gavi-5"</span>, <span class="st">"yf-no-vaccination"</span>, <span class="dv">687</span>)</a></code></pre></div>
<pre><code>## $id
## [1] 687
##
## $uploaded_on
## [1] "2018-04-06T13:08:18.883Z"
##
## $uploaded_by
## [1] "katy.gaythorpe"
##
## $type
## [1] "central-averaged"
##
## $details
## [1] "Averaged over posterior predictive distribution for model parameters"
##
## $status
## [1] "complete"</code></pre>
<p>If there are any reported problems with a burden estimate set, we can examine those with</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1">montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_burden_estimate_set_problems">montagu_burden_estimate_set_problems</a></span>(<span class="st">"IC-Garske"</span>, <span class="st">"201710gavi-5"</span>, <span class="st">"yf-no-vaccination"</span>, <span class="dv">687</span>)</a></code></pre></div>
<pre><code>## list()</code></pre>
<p>and we can retrieve the data for the burden estimate set with:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1">data &lt;-<span class="st"> </span>montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_burden_estimate_set_data">montagu_burden_estimate_set_data</a></span>(<span class="st">"IC-Garske"</span>, <span class="st">"201710gavi-5"</span>, <span class="st">"yf-no-vaccination"</span>, <span class="dv">687</span>)</a>
<a class="sourceLine" id="cb64-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(data)</a></code></pre></div>
<pre><code>##   disease year age country             country_name cohort_size
## 1      YF 2000   0     AGO                   Angola      700752
## 2      YF 2000   0     BDI                  Burundi      240741
## 3      YF 2000   0     BEN                    Benin      262535
## 4      YF 2000   0     BFA             Burkina Faso      479329
## 5      YF 2000   0     CAF Central African Republic      134101
## 6      YF 2000   0     CIV            Cote d'Ivoire      621898
##         cases        dalys       deaths
## 1  318.439060   8546.53100  149.6663700
## 2    1.367271     36.17757    0.6426176
## 3  391.006130  10355.80300  183.7728900
## 4  886.209960  22402.71700  416.5186800
## 5  131.855550   3089.01600   61.9721070
## 6 4620.652300 106431.76000 2171.7068000</code></pre>
<div id="creating-a-new-burden-estimate-set" class="section level3">
<h3 class="hasAnchor">
<a href="#creating-a-new-burden-estimate-set" class="anchor"></a>Creating a new burden estimate set</h3>
<p>A new burden estimate set can be created as follows:-</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1">bsid &lt;-<span class="st"> </span>montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_burden_estimate_set_create">montagu_burden_estimate_set_create</a></span>(</a>
<a class="sourceLine" id="cb66-2" title="2">    <span class="st">"IC-Garske"</span>, <span class="st">"201710gavi-5"</span>, <span class="st">"yf-no-vaccination"</span>, <span class="st">"central-averaged"</span>,</a>
<a class="sourceLine" id="cb66-3" title="3">    <span class="dt">details =</span> <span class="st">"Details about model"</span>)</a></code></pre></div>
<p>The fourth parameter, the type, is either: * <code>central-averaged</code> - for a central estimate that is calculated by the average of a number of runs * <code>central-single-run</code> - for a stand-alone central estimate run.</p>
<p>The result of the burden estimate set creation is the id of the newly created burden estimate set, which must be given when we later upload results.</p>
</div>
<div id="uploading-data" class="section level3">
<h3 class="hasAnchor">
<a href="#uploading-data" class="anchor"></a>Uploading data</h3>
<p>Suppose we have now populated the appropriate burden estimate template with results, and we want to upload it. If <code>results</code> is our completed template, then the simplest upload function call is:-</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1">montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_burden_estimate_set_upload">montagu_burden_estimate_set_upload</a></span>(</a>
<a class="sourceLine" id="cb67-2" title="2">    <span class="st">"IC-Garske"</span>, <span class="st">"201710gavi-5"</span>, <span class="st">"yf-routine-gavi"</span>, bsid, results)</a></code></pre></div>
<p>This will upload the completed data, and close the burden estimate set.</p>
</div>
<div id="plotting-previous-burden-estimate-sets" class="section level3">
<h3 class="hasAnchor">
<a href="#plotting-previous-burden-estimate-sets" class="anchor"></a>Plotting previous burden estimate sets</h3>
<p>One further function call useful for plotting, allows retrieving a particular burden outcome from a burden estimate set, summed across all countries, and dis-aggregated by either age or by year. The result will be a sequence of sets of (x,y) points, suitable for straightforward plotting. For example:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1">data &lt;-<span class="st"> </span>montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_burden_estimate_set_outcome_data">montagu_burden_estimate_set_outcome_data</a></span>(<span class="st">"IC-Garske"</span>, <span class="st">"201710gavi-5"</span>,</a>
<a class="sourceLine" id="cb68-2" title="2">         <span class="st">"yf-no-vaccination"</span>, <span class="dv">687</span>, <span class="st">"cases"</span>, <span class="dt">group_by =</span> <span class="st">"age"</span>)</a>
<a class="sourceLine" id="cb68-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(data)</a></code></pre></div>
<pre><code>##   age    x        y
## 1   0 2000 21955.19
## 2   0 2001 22429.77
## 3   0 2002 22904.21
## 4   0 2003 23388.83
## 5   0 2004 23899.00
## 6   0 2005 24444.64</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(data<span class="op">$</span>x[data<span class="op">$</span>age<span class="op">==</span><span class="dv">20</span>], data<span class="op">$</span>y[data<span class="op">$</span>age<span class="op">==</span><span class="dv">20</span>], <span class="dt">xlab=</span><span class="st">"year"</span>, <span class="dt">ylab=</span><span class="st">"cases"</span>, <span class="dt">main=</span><span class="st">"For age 20"</span>)</a></code></pre></div>
<p>Or to dis-aggregate by year:-</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1">data &lt;-<span class="st"> </span>montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_burden_estimate_set_outcome_data">montagu_burden_estimate_set_outcome_data</a></span>(<span class="st">"IC-Garske"</span>, <span class="st">"201710gavi-5"</span>,</a>
<a class="sourceLine" id="cb71-2" title="2">         <span class="st">"yf-no-vaccination"</span>, <span class="dv">687</span>, <span class="st">"cases"</span>, <span class="dt">group_by =</span> <span class="st">"year"</span>)</a>
<a class="sourceLine" id="cb71-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(data)</a></code></pre></div>
<pre><code>##       year x        y
## 20001 2000 0 21955.19
## 20002 2000 1 20183.78
## 20003 2000 2 18625.01
## 20004 2000 3 17217.85
## 20005 2000 4 15857.58
## 20006 2000 5 14775.94</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(data<span class="op">$</span>x[data<span class="op">$</span>year<span class="op">==</span><span class="dv">2040</span>], data<span class="op">$</span>y[data<span class="op">$</span>year<span class="op">==</span><span class="dv">2040</span>], <span class="dt">xlab=</span><span class="st">"age"</span>, <span class="dt">ylab=</span><span class="st">"cases"</span>, <span class="dt">main=</span><span class="st">"For year 2040"</span>)</a></code></pre></div>
</div>
</div>
<div id="stochastic-runs" class="section level2">
<h2 class="hasAnchor">
<a href="#stochastic-runs" class="anchor"></a>Stochastic Runs</h2>
<p>In order to establish confidence intervals, modelling groups are sometimes asked to run a stochastic ensemble of models. This may be, for instance, 200 instances of a model, with different parameters for each instance. We would call the instance number, between 1 and 200, the <code>run_id</code>, and there would be a unique set of parameters for each.</p>
<p>It is important that for a given <code>run_id</code>, all the scenarios are run with the matching set of parameters for that <code>run_id</code>, so that we can calculate impacts by comparing scenarios.</p>
<p>It is also important that the spread of parameters chosen across the 200 runs significantly captures the range of sensible behaviour of the model, and that the central estimates submitted are somewhere near the centre of the spread of parameters.</p>
<p>Lastly, it is desirable to vary as few parameters as possible, so that with 200 runs, we can see how the parameter changes affect the model outcomes. If there are too many parameters, it may be difficult to ascertain which parameters are causing the changes, or whether the spread of parameters really does capture the significant behaviour of the model.</p>
<p>The R client cannot currently support the full upload process of stochastic runs. Because of their large volume, and the international locations of modelling groups, dropbox provides a more robust service for uploading. It is possible, however, to work with model run parameter sets, and using the Montagu client will make it easier to produce the stochastic results (perhaps directly into a local dropbox folder), in a systematic way.</p>
<div id="model-run-parameter-sets" class="section level3">
<h3 class="hasAnchor">
<a href="#model-run-parameter-sets" class="anchor"></a>Model Run Parameter Sets</h3>
<p>The model run parameter set has a column for <code>run_id</code>, and another column for each parameter being varied. For example:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1">params &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">run_id =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">param_1 =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="dv">5</span>), <span class="dt">param_2 =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb74-2" title="2">params</a></code></pre></div>
<pre><code>##   run_id param_1 param_2
## 1      1       3       2
## 2      2       4       1
## 3      3       2       3
## 4      4       5       5
## 5      5       1       4</code></pre>
<p>This can then be uploaded as follows:-</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1">id &lt;-<span class="st"> </span>montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_model_run_parameter_set_upload">montagu_model_run_parameter_set_upload</a></span>(</a>
<a class="sourceLine" id="cb76-2" title="2">    <span class="st">"IC-Garske"</span>, <span class="st">"201710gavi-5"</span>, <span class="st">"YF"</span>, params)</a></code></pre></div>
<p>The id of the newly created parameter set will be returned.</p>
<p>We can also list the existing model run parameter sets with:-</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_model_run_parameter_sets">montagu_model_run_parameter_sets</a></span>(<span class="st">"IC-Garske"</span>, <span class="st">"201710gavi-5"</span>))</a></code></pre></div>
<pre><code>##   id model    uploaded_by              uploaded_on disease
## 1 20  YFIC katy.gaythorpe 2018-04-06T13:10:35.645Z      YF
## 2 19  YFIC katy.gaythorpe 2018-03-27T10:00:52.710Z      YF
## 3 15  YFIC katy.gaythorpe 2018-01-23T15:52:58.353Z      YF</code></pre>
<p>or for a list of information about a single parameter set:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1">montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_model_run_parameter_set_info">montagu_model_run_parameter_set_info</a></span>(<span class="st">"IC-Garske"</span>, <span class="st">"201710gavi-5"</span>, <span class="dv">20</span>)</a></code></pre></div>
<pre><code>## $id
## [1] 20
##
## $model
## [1] "YFIC"
##
## $uploaded_by
## [1] "katy.gaythorpe"
##
## $uploaded_on
## [1] "2018-04-06T13:10:35.645Z"
##
## $disease
## [1] "YF"</code></pre>
<p>Finally, if we want to retrieve the parameter values for a previous set:-</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1">data &lt;-<span class="st"> </span>montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_model_run_parameter_set_data">montagu_model_run_parameter_set_data</a></span>(<span class="st">"IC-Garske"</span>, <span class="st">"201710gavi-5"</span>, <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb81-2" title="2">data[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a></code></pre></div>
<pre><code>##   run_id     FOI_AGO     FOI_BEN    FOI_BFA      FOI_BDI
## 1      1 0.004549685 0.015696021 0.02084831 3.071269e-05
## 2      3 0.003717290 0.011943511 0.01713641 4.950013e-05
## 3      5 0.003522454 0.009811987 0.01321275 1.058319e-04
## 4      6 0.003485912 0.012657722 0.01655512 7.327719e-05
## 5      8 0.002722810 0.007266782 0.00851512 4.569112e-05</code></pre>
</div>
</div>
<div id="appendix" class="section level2">
<h2 class="hasAnchor">
<a href="#appendix" class="anchor"></a>Appendix</h2>
<div id="models" class="section level3">
<h3 class="hasAnchor">
<a href="#models" class="anchor"></a>Models</h3>
<p>Montagu allows querying of basic information about all models, past and present used in VIMC. These can be listed as follows:-</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1">models &lt;-<span class="st"> </span>montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_models">montagu_models</a></span>()</a>
<a class="sourceLine" id="cb83-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(models)</a></code></pre></div>
<pre><code>##                id
## 1        Yakob-YF
## 2  Winter-Rubella
## 3         PATH-JE
## 4 Harvard-Kim-HPV
## 5        Moore-JE
## 6      Perkins-YF
##                                                                       description
## 1                         generic 201810rfp model - to be updated if joining VIMC
## 2                         generic 201810rfp model - to be updated if joining VIMC
## 3 JE model used in SDF8 and SDF12. This is a static population-based cohort model
## 4                       generic 201804rfp-1 model - to be updated if joining VIMC
## 5                         generic 201810rfp model - to be updated if joining VIMC
## 6                         generic 201810rfp model - to be updated if joining VIMC
##                   citation modelling_group
## 1 &lt;citation for the model&gt;     LSHTM-Yakob
## 2 &lt;citation for the model&gt;       PU-Winter
## 3 &lt;citation for the model&gt;    Suraratdecha
## 4 &lt;citation for the model&gt;     Harvard-Kim
## 5                                UND-Moore
## 6                              UND-Perkins</code></pre>
<p>and a list of information about a particular model by its id can be retrieved like this:-</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1">montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_model">montagu_model</a></span>(<span class="st">"YFIC"</span>)</a></code></pre></div>
<pre><code>## $id
## [1] "YFIC"
##
## $description
## [1] "YF model developed at Imperial College London, used in SDF8 and SDF12. This is a generalised linear regression model fitted to locations of reported yellow fever outbreaks or cases with anthropogenic and environmental covariates generating a risk map for yellow fever across Africa. It was then compared to the available serological data, primarily from central and eastern Africa, to assess the country-specific scale of under-reporting and obtain absolute estimates of transmission intensity in terms of a static force of infection or a basic reproduction number in a dynamical model, taking into account the population-level vaccination coverage through time. Burden and vaccine impact estimates were then generated by combining the transmission intensity with demographic information (population size and age distribution) and observed and hypothetical vaccination coverages in any given location and year."
##
## $citation
## [1] "10.1371/journal.pmed.1001638"
##
## $modelling_group
## [1] "IC-Garske"</code></pre>
<p>Note that the model_id (id column above) is different from the modelling_group_id, and generally the modelling_group_id is the significant identifier required for other Montagu functions.</p>
<div id="demographic-sources" class="section level4">
<h4 class="hasAnchor">
<a href="#demographic-sources" class="anchor"></a>Demographic Sources</h4>
<p>Occasionally, there may be multiple instances of the same demographic data field, but for different sources. For example, infant mortality is provided by both UNWPP, and IGME (ChildMortality.org). Neither sources are ideal, and Montagu provides a documented compromise between the two sources for infant, and especially neonatal mortality.</p>
<p>If an example arises where there are two instances of the same data field, then they will have a different data_source, which will need to be specified in the form:-</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1">montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_demographic_data">montagu_demographic_data</a></span>(<span class="st">"Modelling-Group"</span>, <span class="st">"Touchstone"</span>,</a>
<a class="sourceLine" id="cb87-2" title="2">                                  <span class="dt">source_code =</span> <span class="st">"The-Source-Code"</span>)</a></code></pre></div>
<p>where the The-Source-Code is in the table returned by</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1">montagu<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/montagu/topics/montagu_demographics_list">montagu_demographics_list</a></span>(<span class="st">"Touchstone"</span>)</a></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#burden-estimate-sets">Burden Estimate Sets</a></li>
      <li><a href="#stochastic-runs">Stochastic Runs</a></li>
      <li><a href="#appendix">Appendix</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Rich FitzJohn, Wes Hinsley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
