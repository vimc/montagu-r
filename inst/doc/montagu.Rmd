---
title: "Montagu API"
author: "VIMC Technical Team"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Montagu API}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

Montagu has an HTTP API, and this package wraps it to allow
programmatic access to the data in montagu.  The API is evolving and
this package does not yet implement the full set of API features.

The package currently contains two somewhat unrelated tasks -
authentication and working with the data.  As things evolve then this
will become less painful to use.

For external users, this is particularly awkward - internally we have
several copies of the montagu server for different purposes, but
externally there is only one.

### Authentication

```{r}
montagu::montagu_server_global_default_set(
  montagu::montagu_server("production", "montagu.vaccineimpact.org"))
```

On the first request you will be prompted for a password

```{r}
montagu::montagu_touchstones_list()
```

### Demographic data

List available demographic data (this is cached within a session)

```{r}
touchstone_id <- "201710gavi-5"
montagu::montagu_demographics_list(touchstone_id)
```

From this list, download a data set

```{r}
dat <- montagu::montagu_demographic_data(
    "cbr", "201710gavi-5", source_code = "dds-201710")
head(dat)
```
